In the following, we run our algorithm Algorithm 3 GuessingBivar(ùíñ) on the same
example described in example_iterative.md. 
The Maple code is available at
https://github.com/ktran11/CrecbiseqGuessing/blob/main/maple/bivariate_recursive.mpl.


## Context
Let $\mathbb{K} = \mathbb{F}_{97}$.
We consider the ideal of relation $I(u)$ generated by the following reduced Gr√∂bner
basis $G_{u}$


\begin{align*}
&x^5+60x^4+45x^3+77x^2+10x+28, \\
&yx^3+yx^2+84yx+69y+30x^4+59x^3+27x^2+44x+61,\\
&y^2x^2+34y^2x+42y^2+12yx^2+20yx+19y+28x^4+4x^3+18x^2+43x+70, \\
&y^3+88y^2x+86y^2+84yx^2+33yx+31y+88x^4+65x^3+96x^2+67x+45 \\
\end{align*}



We have the parameter $d_x = 5, d_y = 3$ and set $D_x = 10, D_y = 6$.

We build a sequence $\mathbf{u}=(u_{i,j})_{(i,j)\in\mathbb{N}^2}$
with random initial terms that we extend using the
relations given by $G_u$.

\[
\begin{array}{|c|c|c|c|c|c|c|c|c|c|c|c|}
\vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots
& \vdots & \vdots & \vdots & \vdots & \vdots
\\
\vdots & 77 & 17 & 3 & 8 & 13 & 86 & 20 & 70 & 49 & 70 & 50
\\
\vdots & 11 & 9 & 61 & 23 & 24 & 93 & 19 & 7 & 89 & 10 & 16
\\
\vdots & 3 & 20 & 67 & 78 & 50 & 75 & 79 & 26 & 6 & 34 & 73
\\
\vdots & 38 & 80 & 91 & 65 & 0 & 38 & 41 & 4 & 56 & 4 & 17
\\
\vdots & 22 & 40 & 1 & 35 & 47 & 41 & 39 & 63 & 43 & 41 & 80
\\
j=1 & 79 & 95 & 10 & 45 & 66 & 74 & 42 & 75 & 57 & 90 & 64
\\
j=0 & 29 & 5 & 31 & 39 & 23 & 18 & 58 & 53 & 38 & 36 & 83
\\
u_{i,j} & i = 0 & i = 1 & \cdots & \cdots & \cdots & \cdots
& \cdots & \cdots & \cdots & \cdots & \cdots
\end{array}
\]

First we compute the C-relation on the first slice,

\[
\begin{array}{|c|c|c|c|c|c|c|c|c|c|c|c|}
j=0 & 29 & 5 & 31 & 39 & 23 & 18 & 58 & 53 & 38 & 36 & 83
\\
u_{i,j} & i = 0 & i = 1 & \cdots & \cdots & \cdots & \cdots
& \cdots & \cdots & \cdots & \cdots & \cdots
\end{array}
\]
which can be read off from the polynomial
$lc(r_{-1})$.

$f_0 = GuessingUnivar(lc(r_{-1})) = x^5+60x^4+45x^3+77x^2+10x+28$

## Input of the Half-Gcd-Seq algorithm

\[
r_{-1} :=
(29x^{10}+5x^9+31x^8+39x^7+23x^6+18x^5+58x^4+53x^3+38x^2+36x+83)y^7,
\]

\begin{align*}
r_0 := &(29x^{10}+5x^9+31x^8+39x^7+23x^6+18x^5+58x^4+53x^3+38x^2+36x+83)y^6 \\
  & + (79x^{10}+95x^9+10x^8+45x^7+66x^6+74x^5+42x^4+75x^3+57x^2+90x+64)y^5 \\
  & + (22x^{10}+40x^9+x^8+35x^7+47x^6+41x^5+39x^4+63x^3+43x^2+41x+80)y^4 \\
  & + (38x^{10}+80x^9+91x^8+65x^7+38x^5+41x^4+4x^3+56x^2+4x+17)y^3 \\
  & + (3x^{10}+20x^9+67x^8+78x^7+50x^6+75x^5+79x^4+26x^3+6x^2+34x+73)y^2 \\
  & + (11x^{10}+9x^9+61x^8+23x^7+24x^6+93x^5+19x^4+7x^3+89x^2+10x+16)y \\
  & + (77x^{10}+17x^9+3x^8+8x^7+13x^6+86x^5+20x^4+70x^3+49x^2+70x+50)1, 
\end{align*}


$f_0 =   x^5+60x^4+45x^3+77x^2+10x+28$ and $k = \lfloor D_y /2 \rfloor = 3$. 




# Root Call Input: $(r_{-1}, r_0, f_0, 3)$ 
We have $d:= \lceil k/2 \rceil = 2$ so the first recursive call has for input
\[ r_{-1}\!\!\upharpoonright_{2(d-1)} := (29x^{10}+5x^9+31x^8+39x^7+23x^6+18x^5+58x^4+53x^3+38x^2+36x+83)y^2\] 
	and 
	

\begin{align*}
r_0 \!\!\upharpoonright_{2(d-1)-1}:=&(29x^{10}+5x^9+31x^8+39x^7+23x^6+18x^5+58x^4+53x^3+38x^2+36x+83)y \\
	 & + (79x^{10}+95x^9+10x^8+45x^7+66x^6+74x^5+42x^4+75x^3+57x^2+90x+64)
\end{align*} 
	


# In the recursive call with Input: $(r_{-1}\!\!\upharpoonright_{2}, r_0\!\!\upharpoonright_{1}, f_0, 1)$

We have $d:= \lceil 1/2 \rceil = 1$ and 
\[ (r_{-1}\!\!\upharpoonright_{2})\!\!\upharpoonright_{0}  =
(29x^{10}+5x^9+31x^8+39x^7+23x^6+18x^5+58x^4+53x^3+38x^2+36x+83)\] 

and $r_0 = 0$. 

The first recursive call is on the input
$(r_{-1}\!\!\upharpoonright_{2})\!\!\upharpoonright_{0}, 0, f_0, 0)$ and it
outputs $
I_2 :=
\begin{bmatrix}
1 & 0 \\
0 &  1
\end{bmatrix}, [], []$ 


On line 4, we update the input by computing 
\[ 
\begin{bmatrix}
r_{-1}\!\!\upharpoonright_{2} \\
r_{0} \!\!\upharpoonright_{1}
\end{bmatrix} = I_2 
\begin{bmatrix}
r_{-1}\!\!\upharpoonright_{2} \\
r_{0} \!\!\upharpoonright_{1}
\end{bmatrix}\] 


The remainders do not satisfy the condition $\deg_y(r_{-1}) -1 > \deg_y(r_0)$ so
the computation continues.

We compute, as in the iterative version, the quotient matrix $Q_0$ and the
relation $f_0$ by calling the algorithm

\begin{align*}
	Q_0,f_0 &:= QuoTwoVar(r_{-1}\!\!\upharpoonright_{2}, r_0
\!\!\upharpoonright_{1}, f_0)\\ 
	&= \begin{bmatrix}
0 & 1 \\
96 &  y + 4x^4+53x^3+33x^2+92x+59 \\
\end{bmatrix}, x^5+60x^4+45x^3+77x^2+10x+28
\end{align*}

We apply the transformation on the input and obtain 

\begin{align*}
	\begin{bmatrix}
	r_{0}\!\!\upharpoonright_{1}\\
	r_{1} \!\!\upharpoonright_{-1}
	\end{bmatrix} &:= Q_0 
\cdot_{f_0} \begin{bmatrix}
r_{-1}\!\!\upharpoonright_{2} \\
r_{0} \!\!\upharpoonright_{1}
\end{bmatrix}
\end{align*}

The second recursive call starts with the input
$((r_{0}\!\!\upharpoonright_{1})\!\!\upharpoonright_{0}, 0, f_0, 0)$ and outputs
$I_2, [], []$. 

Finally, we return in the root call with the output $Q_0, [Q_0], [f_0]$.

# Second part of the Root call Input  $(r_{-1}, r_0, f_0, 3)$ 
We update the input with the matrix $Q_0$ and obtain

\begin{align*}
r_0 := &(29x^{10}+5x^9+31x^8+39x^7+23x^6+18x^5+58x^4+53x^3+38x^2+36x+83)y^6 \\
  & + (79x^{10}+95x^9+10x^8+45x^7+66x^6+74x^5+42x^4+75x^3+57x^2+90x+64)y^5 \\
  & + (22x^{10}+40x^9+x^8+35x^7+47x^6+41x^5+39x^4+63x^3+43x^2+41x+80)y^4 \\
  & + (38x^{10}+80x^9+91x^8+65x^7+38x^5+41x^4+4x^3+56x^2+4x+17)y^3 \\
  & + (3x^{10}+20x^9+67x^8+78x^7+50x^6+75x^5+79x^4+26x^3+6x^2+34x+73)y^2 \\
  & + (11x^{10}+9x^9+61x^8+23x^7+24x^6+93x^5+19x^4+7x^3+89x^2+10x+16)y \\
  & + (77x^{10}+17x^9+3x^8+8x^7+13x^6+86x^5+20x^4+70x^3+49x^2+70x+50)1, 
\end{align*}
and 
\[
\begin{align*}
	r_1 = & (9x^{10}+10x^9+38x^8+53x^7+42x^6+62x^5+28x^4+14x^3+49x^2+44x+15)y^5+ \\
    & (11x^{10}+37x^9+72x^8+38x^7+91x^6+91x^5+22x^4+23x^3+95x^2+44x+89)y^4+ \\
    & (48x^{10}+83x^9+14x^8+81x^7+87x^5+47x^4+17x^3+23x^2+59x+37)y^3+ \\
    & (37x^{10}+73x^9+59x^8+83x^7+12x^6+3x^5+52x^4+32x^3+49x^2+77x+1)y^2+ \\
    & (32x^{10}+27x^9+69x^8+14x^7+87x^6+87x^5+78x^4+94x^3+58x^2+50x+38)y+ \\
    & 86x^{10}+54x^9+63x^8+26x^7+53x^6+73x^5+52x^4+3x^3+10x^2+31x+36 \\
\end{align*}
\]

The remainders do not satify the condition of line 5 so we can compute $Q_1,
f_1$ with $ QuoTwoVar(r_{0}\!\!\upharpoonright_{2}, r_1
\!\!\upharpoonright_{1}, f_0)$ and we obtain

\[
Q_1 =
\begin{bmatrix}
0 & 1 \\
16x^4+31x^3+64x^2+52x+82 & y + 25x^2+90x+78 \\
\end{bmatrix},
\quad f_1 = x^3+x^2+84x+69
\]

We apply the transformation and obtain 

\begin{align*}
	\begin{bmatrix}
	r_{1}\\
	r_{2}
	\end{bmatrix} &:= Q_1 
\cdot_{f_0} \begin{bmatrix}
r_{0} \\
r_{1}
\end{bmatrix}
\end{align*}

with \begin{align*}
r_2  = & (84x^{10}+42x^9+88x^8+94x^7+92x^6+5x^5+40x^4+79x^3+96x^2+14x+51)y^4 \\
    & + (41x^{10}+90x^9+68x^8+19x^7+87x^6+27x^5+84x^4+84x^3+18x^2+31x+33)y^3 \\
    & + (64x^{10}+73x^9+68x^8+54x^7+61x^6+23x^5+51x^4+16x^3+30x^2+54x+8)y^2 \\
    & + (13x^{10}+38x^9+13x^8+55x^7+90x^6+80x^5+77x^4+38x^3+11x^2+21x+69)y \\
    & +  37x^{10}+17x^9+61x^8+30x^7+48x^6+52x^5+54x^4+65x^3+83x^2+41x+93 \\
\end{align*}


Then, we have the second recursive call on the input
$(r_1\!\!\upharpoonright_{2}, r_2\!\!\upharpoonright_{1}, f_0, 1)$ 


# In the recursive call with Input: $(r_1\!\!\upharpoonright_{2},r_2\!\!\upharpoonright_{1}, f_0, 1)$ 

As before, we have $d:= \lceil 1/2 \rceil = 1$ and 
\[ (r_{1}\!\!\upharpoonright_{2})\!\!\upharpoonright_{0}  =
(9x^{10}+10x^9+38x^8+53x^7+42x^6+62x^5+28x^4+14x^3+49x^2+44x+15)\] 

and $r_2 = 0$. 

The first recursive call is on the input
$(r_{1}\!\!\upharpoonright_{2})\!\!\upharpoonright_{0}, 0, f_0, 0)$ and it
outputs $I_2 , [], []$ 


On line 4, we update the input by computing 
\[ 
\begin{bmatrix}
r_{1}\!\!\upharpoonright_{2} \\
r_{2} \!\!\upharpoonright_{1}
\end{bmatrix} = I_2 
\begin{bmatrix}
r_{1}\!\!\upharpoonright_{2} \\
r_{2} \!\!\upharpoonright_{1}
\end{bmatrix}\] 


The remainders do not satisfy the condition $\deg_y(r_{1}) -1 > \deg_y(r_2)$ so
the computation continues. 

and we compute the quotient matrix $Q_2$ and the
relation $f_2$ by calling the algorithm

\begin{align*}
	Q_2,f_2 &:= QuoTwoVar(r_{1}\!\!\upharpoonright_{2}, r_2
\!\!\upharpoonright_{1}, f_0)\\ 
	&=\begin{bmatrix}
0 & 1 \\
72x^2+46x+2 & y+72+67x \\
\end{bmatrix}, x^2 + 34x + 42
\end{align*}

We apply the transformation on the input and obtain 

\begin{align*}
	\begin{bmatrix}
	r_{2}\!\!\upharpoonright_{1}\\
	r_{3} \!\!\upharpoonright_{-1}
	\end{bmatrix} &:= Q_2 
\cdot_{f_0} \begin{bmatrix}
r_{1}\!\!\upharpoonright_{2} \\
r_{2} \!\!\upharpoonright_{1}
\end{bmatrix}
\end{align*}

The second recursive call starts with the input
$((r_{1}\!\!\upharpoonright_{1})\!\!\upharpoonright_{0}, 0, f_0, 0)$ and outputs
$I_2, [], []$. 

Finally, we return in the root call with the output $Q_2, [Q_2], [f_2]$.


# Back to the root call 

In the first recursive call, we have $R, T, \mathcal{F}_0 := Q_0, [Q_0], [f_0]$
and we have compute the quotient matrix and the relation $Q_1, f_1$ during the
root call. 

In the second recursive call, we have $S, U, \mathcal{F}_1 := Q_2, [Q_2],
[f_2]$. 

The output of the root call is then $Q_2Q_1Q_0 \text{rem} f_0, [Q_0, Q_1, Q_2],
[f_0, f_1, f_2]$

At the end of the call Half-Gcd-Seq, we have enough information to compute a
Gr√∂bner basis of $I(u)$. 

## `GuessingBivar`

`GuessingBivar` initialization sets $f_0$ as the first element $g_0$ of the Grobner basis.

The next computations correspond to the `for` loop on line 6 of Algorithm 3 `GuessingBivar(ùíñ)`.

### First loop

The matrix product $Q_1Q_0$ is

\[
\begin{bmatrix}
96 & y+4x^4+53x^3+33x^2+92x+59 \\
96y+72x^2+7x+19 & y^2+(4x^4+53x^3+58x^2+85x+40)y+72x^4+67x^3+74x^2+23x+83 \\
\end{bmatrix}
\]

whose entry on the first line, second column is $t_1 = y+4x^4+53x^3+33x^2+92x+59$.
Its modular product $g_1 := t_1f_1 \bmod f_0$ is the second element of the Grobner basis.

\[
g_1 = (x^3+x^2+84x+69)y+ 30x^4+59x^3+27x^2+44x+61
\]

### Second loop

The matrix product

\[
Q_2 Q_1 Q_0 =
\begin{bmatrix}
s_2 & t_2 \\
s_3 & t_3 \\
\end{bmatrix}
\]

where

\begin{align*}
s_2 = & 96y+72x^2+7x+19\\
t_2 = & y^2+(4x^4+53x^3+58x^2+85x+40)y+72x^4+67x^3+74x^2+23x+83\\
s_3 = & 96y^2+(72x^2+37x+44)y+71x^3+52x^2+82x+8\\
t_3 = & y^3+(4x^4+53x^3+58x^2+55x+15)y^2+(53x^4+74x^3+51x^2+78x+20)y \\
      & +33x^4+14x^3+70x^2+87x+71\\
\end{align*}

Its modular product $g_2 := t_2 f_2 \bmod f_0$ is the third element of the Grobner basis.

\[
g_2 = (x^2+34x+42)y^2+ (58x^4+62x^3+38x^2+90x+4)y+ 50x^4+39x^3+36x^2+34x+94
\]

### After the loop

The loop stops after its second iteration because the degree sequence is no longer normal.
The last step 11 of Algorithm 3 `GuessingBivar(ùíñ)` appends $g_3 := t_{d_y} = t_3$ to the Grobner basis.

## Output

The minimal Grobner basis on output is $G := \{f_0, g_1, g_2, t_{d_y}\}$, with

\begin{align*}
f_0 = &     x^5+60x^4+45x^3+77x^2+10x+28\\
g_1 = &     (x^3+x^2+84x+69)y+ 30x^4+59x^3+27x^2+44x+61,\\
g_2 = &     (x^2+34x+42)y^2+ (58x^4+62x^3+38x^2+90x+4)y+ 50x^4+39x^3+36x^2+34x+94,\\
t_{d_y} = &    y^3+(4x^4+53x^3+58x^2+55x+15)y^2+(53x^4+74x^3+51x^2+78x+20)y \\
          & + 33x^4+14x^3+70x^2+87x+71 \\
\end{align*}

This Grobner basis does not match $G_u$ because $G$ is only minimal whereas $G_u$ is reduced, *i.e* minimal and the elements in the basis are reduced w.r.t. the other ones.

Note that $G$ has exactly the same leading monomials as all the ones in $G_u$.
Furthermore, the `Maple` command
`Groebner:-InterReduce(G,plex(y,x),characteristic=97)` yields the same polynomials
as in $G_u$, hence the output $G$ is a minimal Gr√∂bner of $I(u)$.

Note that the elements in our output Grobner basis have support in the $(d_x,d_y)$-box, *i.e.* their partial degrees are bounded by $d_x$ and $d_y$.
